#action : print the dest part of the pcap files
# use : pcap$ ls -1 | parallel --gnu " python ../test_pyshark2.py -f {1}"

import argparse
import sys
import pyshark

argParser=argparse.ArgumentParser(description='Pcap classifier')
argParser.add_argument('-f',action='append',help='Filename')
args=argParser.parse_args()

if args.f is not None:
	
	pcap_file_name = args.f[0]
	print('nom : ' + pcap_file_name)
	
	#pcap_file contains all the packets from the pcap file.

	pcap_file = pyshark.FileCapture('./'+pcap_file_name)
	nb_packet=0	

	for packet in pcap_file:
    		print  nb_packet
		#print(pcap_file[nb_packet]['ip'].dst)

		#trouver comment filtrer si http server ou non
		print(pcap_file[nb_packet]['http'].server)
		nb_packet=nb_packet+1

else:
	argParser.print_help()
