#action : print the http server used by the pcap
# use : pcap$ ls -1 | parallel --gnu " python ../pyshark_filter_http_server -f {1}"

import argparse
import sys
import pyshark

argParser=argparse.ArgumentParser(description='Pcap classifier')
argParser.add_argument('-f',action='append',help='Filename')
args=argParser.parse_args()

if args.f is not None:
	
	pcap_file_name = args.f[0]
	print('nom : ' + pcap_file_name)
	
	#pcap_file contains all the packets from the pcap file.

	pcap_file_filtered = pyshark.FileCapture('./'+pcap_file_name, display_filter='http.server')

	for packet in pcap_file_filtered:
		print(packet['http'].server)

else:
	argParser.print_help()
